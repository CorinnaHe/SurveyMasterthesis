{% extends "global/Page.html" %}
{% load otree %}

{% block content %}
<link rel="stylesheet" href="{{ static 'global/style.css' }}">


<input type="hidden" name="page_duration_stage2" id="page_duration_stage2"/>

<script>
var startTime;
window.onload = function() {
    startTime = Date.now();
};
function getTime(){
    var page_duration_stage2 = Date.now() - startTime;
    document.getElementById('page_duration_stage2').value = page_duration_stage2/1000;
}

</script>

<h3 style="margin-bottom: 30px;">{{ trial_label }}  {{ trial_number }}/15 ‚Äì Step 2</h3>

<!-- ========================= -->
<!-- features (table version) -->
<!-- ========================= -->

<h5>üîç Applicant {{ trial_number }}</h5>

<table class="feature-overview-vertical">
    {% for f in features %}
        <tr>
            <td class="feature-name">
                {% if f.group == "Demographic information" %}
                    üë§
                {% elif f.group == "Financial information" %}
                    üí∞
                {% elif f.group == "Credit information" %}
                    üí≥
                {% endif %}
                {{ f.label }}
            </td>
            <td>
                {{ f.value }}
            </td>
        </tr>
    {% endfor %}
</table>

<!-- ========================= -->
<!-- AI support -->
<!-- ========================= -->

<div class="ai-support-box">

    <div class="ai-support-header">
        <span class="ai-icon">ü§ñ</span>
        <span class="ai-title">AI Support</span>
    </div>

    {% if condition == "C1" %}

    <p>
        Based on the available information, the AI predicts:
    </p>

    <p class="ai-prediction">
        <strong>‚Üí {{ ai_label }}</strong>
    </p>

    <p>
        Out of 100 similar past cases, predictions like this were
        <strong>correct in about {{ ai_correct_predictions }} cases</strong>
        and
        <strong>incorrect in about {{ ai_incorrect_predictions }} cases</strong>.
    </p>

    {% elif condition == "C2" %}

    <p>
        Based on the available information, the AI predicts:
    </p>

    <p class="ai-prediction">
        <strong>‚Üí {{ ai_label }}</strong>
    </p>

    <p>
        The AI has <strong>{{ ai_confidence_level }}</strong> confidence in this prediction.
    </p>

    {% elif condition == "C3" %}

    <p>
        Based on the available information, the AI identifies the following outcomes as plausible:
    </p>

    <p class="ai-prediction">
        <strong>‚Üí {{ cp_set_text }}</strong>
    </p>

    <p>
        Out of 100 similar past cases, the true outcome was
        <strong>included in this set in about {{ cp_coverage_correct }} cases</strong>
        and
        <strong>not included in about {{ cp_coverage_incorrect }} cases</strong>.
    </p>

    {% endif %}

</div>


<p>
You initially classified this applicant as:
</p>

<p><strong>‚Üí {{ initial_decision_label }}</strong></p>

<hr>

<!-- ========================= -->
<!-- Final decision -->
<!-- ========================= -->

<div class="question-box">
    {{ formfield 'final_decision' }}
</div>

<p>{{form.final_confidence.label}}</p>
<table class="table table-bordered text-center scale-table">
    <tr>
        {% for choice in form.final_confidence %}
            <th style="width: 8%;">
                {{ choice.label }}
            </th>
        {% endfor %}
    </tr>

    <tr>
        <!-- Radio buttons -->
        {% for choice in form.final_confidence %}
            <td>
                {{ choice }}
            </td>
        {% endfor %}
    </tr>
</table>

<button class="otree-btn-next" onclick="getTime()">Continue</button>

{% endblock %}
